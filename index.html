<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Calendario</title>

<!-- âœ… PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">
<link rel="apple-touch-icon" href="icon-192.png.PNG">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    display: flex;
    justify-content: center;
    margin-top: 30px;
}

.contenedor {
    background: white;
    padding: 15px;
    border-radius: 14px;
    width: 320px;
}

.cabecera {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.boton {
    cursor: pointer;
    font-size: 18px;
    padding: 4px 10px;
    border-radius: 6px;
    background: #e6e6e6;
}

.titulo {
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
}

.calendario {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 6px;
}

.dia-semana {
    text-align: center;
    font-size: 12px;
    color: #666;
    font-weight: bold;
}

.dia {
    width: 40px;
    height: 40px;
    border: 1px solid #ddd;
    text-align: center;
    line-height: 40px;
    font-weight: bold;
    border-radius: 8px;
    background: #fafafa;
}

.dia.marcado {
    background: #ffcccc;
    color: red;
}

.dia.hoy {
    background: #ff3b3b;
    color: white;
}

/* Vista anual */
.anual {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

.mes-anual {
    padding: 15px 0;
    background: #f7f7f7;
    text-align: center;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
}

/* ðŸŒ™ MODO OSCURO */
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #fff;
  }

  .contenedor {
    background: #1c1c1e;
  }

  .boton {
    background: #2c2c2e;
    color: #fff;
  }

  .dia-semana {
    color: #b0b0b5;
  }

  .dia {
    background: #2c2c2e;
    border: 1px solid #3a3a3c;
    color: #fff;
  }

  .dia.marcado {
    background: #4a1c1c;
    color: #ff6b6b;
  }

  .dia.hoy {
    background: #ff3b30;
    color: #fff;
  }

  .mes-anual {
    background: #2c2c2e;
    color: #fff;
  }
}
</style>
</head>

<body>

<div class="contenedor">
    <div class="cabecera">
        <div class="boton" id="prev">â€¹</div>
        <div class="titulo" id="titulo"></div>
        <div class="boton" id="next">â€º</div>
    </div>

    <div id="contenido"></div>
</div>

<script>
const meses = [
    "Enero","Febrero","Marzo","Abril","Mayo","Junio",
    "Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"
];

const diasSemana = ["L","M","M","J","V","S","D"];

const hoy = new Date();
let fecha = new Date(2026, hoy.getMonth(), 1);
let vista = "mes";

const titulo = document.getElementById("titulo");
const contenido = document.getElementById("contenido");

const clave = (a,m,d) => `${a}-${m+1}-${d}`;

document.getElementById("prev").onclick = () => {
    fecha.setMonth(fecha.getMonth() - 1);
    render();
};

document.getElementById("next").onclick = () => {
    fecha.setMonth(fecha.getMonth() + 1);
    render();
};

titulo.onclick = () => {
    vista = vista === "mes" ? "aÃ±o" : "mes";
    render();
};

function render() {
    contenido.innerHTML = "";
    titulo.textContent = meses[fecha.getMonth()] + " " + fecha.getFullYear();
    vista === "mes" ? renderMes() : renderAÃ±o();
}

function renderMes() {
    const cal = document.createElement("div");
    cal.className = "calendario";

    diasSemana.forEach(d => {
        const ds = document.createElement("div");
        ds.className = "dia-semana";
        ds.textContent = d;
        cal.appendChild(ds);
    });

    const aÃ±o = fecha.getFullYear();
    const mes = fecha.getMonth();
    const primerDia = new Date(aÃ±o, mes, 1).getDay() || 7;
    const totalDias = new Date(aÃ±o, mes + 1, 0).getDate();

    for (let i = 1; i < primerDia; i++) {
        cal.appendChild(document.createElement("div"));
    }

    for (let d = 1; d <= totalDias; d++) {
        const div = document.createElement("div");
        div.className = "dia";

        const fechaDia = new Date(aÃ±o, mes, d);
        const hoyPlano = new Date(hoy.getFullYear(), hoy.getMonth(), hoy.getDate());

        if (fechaDia < hoyPlano) {
            div.textContent = "X";
            div.classList.add("marcado");
            localStorage.setItem(clave(aÃ±o,mes,d), "x");
        }
        else if (
            d === hoy.getDate() &&
            mes === hoy.getMonth() &&
            aÃ±o === hoy.getFullYear()
        ) {
            div.textContent = d;
            div.classList.add("hoy");
        } 
        else {
            div.textContent = d;
        }

        if (localStorage.getItem(clave(aÃ±o,mes,d)) === "x") {
            div.textContent = "X";
            div.classList.add("marcado");
        }

        cal.appendChild(div);
    }

    contenido.appendChild(cal);
}

function renderAÃ±o() {
    const grid = document.createElement("div");
    grid.className = "anual";

    meses.forEach((m, i) => {
        const div = document.createElement("div");
        div.className = "mes-anual";
        div.textContent = m;
        div.onclick = () => {
            fecha.setMonth(i);
            vista = "mes";
            render();
        };
        grid.appendChild(div);
    });

    contenido.appendChild(grid);
}

render();
</script>

</body>
</html>
